<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pepe Pizza</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="stylesPhone.css" />
    <link rel="icon" type="image/png" href="images/Icon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="header">
      <img src="Images/logo.png" alt="" class="logoImage" />
      <img src="Images/title.png" alt="" class="titleImage" />
    </nav>
    <hr style="border: 1px solid black" />

    <div class="bande-event">
      <marquee direction="5px">événement à venir : aucun</marquee>
    </div>

    <br />

    <div class="phone-btn">
      <div class="btn-circle">
        <a href="index.html#traditionnelles" class="btn-duo-left">Menu</a>
        <a href="lieux.html" class="btn-duo-center">Lieux</a>
        <a href="apropos.html" class="btn-duo-right">Infos</a>
      </div>

      <div class="btn-large">
        <a href="events.html" class="btn-duo-right">événements</a>
      </div>
    </div>

    <div class="other-btn">
      <div class="btn-head">
        <a href="index.html#traditionnelles" class="btn-duo-left">Menu</a>
        <a href="lieux.html" class="btn-duo-center">Lieux</a>
        <a href="apropos.html" class="btn-duo-right">Infos</a>
        <a href="events.html" class="btn-duo-right">événements</a>
      </div>
    </div>


    <br />
    <h1 class="titre">Les pizzas</h1>

    <div class="pop-up-appel">
      <a href="tel:+33615287535">
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.2em;
          "
        >
          <img
            src="Images/icons/phone.svg"
            style="filter: invert(); height: 1em"
            alt=""
          />
          APPELER
        </div>
      </a>
    </div>

    <div id="pizzas-container"></div>

    <br />
    Râpés : mélange emmental & mozarella <br />
    <br />

    <footer>
      <p>2026 Pepe Pizza. Tous droits réservés.</p>
    </footer>

    <!-- lightbox global -->
    <div id="lightbox" class="lightbox" aria-hidden="true">
      <img id="lightbox-img" alt="" />
    </div>

    <script>
      fetch("data.json")
        .then((response) => response.json())
        .then((data) => {
          const container = document.getElementById("pizzas-container");
          data.categories.forEach((category) => {
            const categoryDiv = document.createElement("div");
            categoryDiv.id = category.id;
            categoryDiv.className = category.class;
            categoryDiv.innerHTML = `<div>${category.name}</div>`;
            container.appendChild(categoryDiv);
            category.pizzas.forEach((pizza) => {
              const pizzaDiv = document.createElement("div");
              pizzaDiv.className = "pizza";
              pizzaDiv.innerHTML = `
                <img class="pizza-image" src="Images/pizza/${category.name}/${pizza.name}.png" alt="${pizza.name}" />
                <table class="pizza-header">
                  <tr>
                    <td class="pizza-name">${pizza.name}</td>
                    <td class="pizza-price">
                      <span class="small-price">${pizza.smallPrice}</span> &nbsp;
                      <span class="big-price">${pizza.bigPrice}</span>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="2" class="pizza-description">${pizza.description}</td>
                  </tr>
                </table>
              `;
              container.appendChild(pizzaDiv);
            });
          });
        })
        .catch((error) => console.error("Error loading pizzas:", error));
      fetch('events.json')
      .then(response => response.json())
      .then(data => {
        const firstEvent = data.events[0];
        if (firstEvent) {
        const eventDate = new Date(firstEvent.date);
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        if (eventDate >= today) {
          const formattedDate = eventDate.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
          document.querySelector('.bande-event marquee').textContent = `événement à venir : ${formattedDate} | |  ${firstEvent.title}`;
        } else {
          document.querySelector('.bande-event marquee').textContent = data.afficher;
        }
        } else {
        document.querySelector('.bande-event marquee').textContent = data.afficher;
        }
      })
      .catch(error => console.error('Error loading events for marquee:', error));
      
      // script lightbox
      const lightbox = document.getElementById("lightbox");
      const lbImg = document.getElementById("lightbox-img");

      document.querySelectorAll(".pizza-image").forEach((img) => {
        img.style.cursor = "zoom-in";
        img.addEventListener("click", () => {
          lbImg.src = img.src;
          lbImg.alt = img.alt || "";
          lightbox.classList.add("show");
          document.body.style.overflow = "hidden";
          lightbox.setAttribute("aria-hidden", "false");
        });
      });

      lightbox.addEventListener("click", () => closeLightbox());
      lbImg.addEventListener("click", (e) => e.stopPropagation()); // clique sur l'image ne ferme pas

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeLightbox();
      });

      function closeLightbox() {
        lightbox.classList.remove("show");
        document.body.style.overflow = "";
        lightbox.setAttribute("aria-hidden", "true");
        lbImg.src = "";
      }
    </script>
  </body>
  <br /><br /><br /><br />
</html>
